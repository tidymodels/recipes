<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate a preprocessing recipe — prep • recipes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a preprocessing recipe — prep"><meta name="description" content="For a recipe with at least one preprocessing operation, estimate the required
parameters from a training set that can be later applied to other data sets."><meta property="og:description" content="For a recipe with at least one preprocessing operation, estimate the required
parameters from a training set that can be later applied to other data sets."><meta property="og:image" content="https://recipes.tidymodels.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="recipes.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">recipes</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/recipes.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Dummies.html">Handling categorical predictors</a></li>
    <li><a class="dropdown-item" href="../articles/Selecting_Variables.html">Selecting variables</a></li>
    <li><a class="dropdown-item" href="../articles/Roles.html">Roles in recipes</a></li>
    <li><a class="dropdown-item" href="../articles/Skipping.html">On skipping steps</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/recipes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate a preprocessing recipe</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/recipes/blob/main/R/recipe.R" class="external-link"><code>R/recipe.R</code></a></small>
      <div class="d-none name"><code>prep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For a recipe with at least one preprocessing operation, estimate the required
parameters from a training set that can be later applied to other data sets.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prep</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'recipe'</span></span>
<span><span class="fu">prep</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  training <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fresh <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  retain <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log_changes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strings_as_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an <code><a href="recipe.html">recipe()</a></code> object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to or from other methods (not currently
used).</p></dd>


<dt id="arg-training">training<a class="anchor" aria-label="anchor" href="#arg-training"></a></dt>
<dd><p>A data frame, tibble, or sparse matrix from the <code>Matrix</code>
package, that will be used to estimate parameters for preprocessing. See
<a href="sparse_data.html">sparse_data</a> for more information about use of sparse data.</p></dd>


<dt id="arg-fresh">fresh<a class="anchor" aria-label="anchor" href="#arg-fresh"></a></dt>
<dd><p>A logical indicating whether already trained operation should be
re-trained. If <code>TRUE</code>, you should pass in a data set to the argument
<code>training</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical that controls whether progress is reported as
operations are executed.</p></dd>


<dt id="arg-retain">retain<a class="anchor" aria-label="anchor" href="#arg-retain"></a></dt>
<dd><p>A logical: should the <em>preprocessed</em> training set be saved into
the <code>template</code> slot of the recipe after training? This is a good idea if
you want to add more steps later but want to avoid re-training the existing
steps. Also, it is advisable to use <code>retain = TRUE</code> if any steps use the
option <code>skip = FALSE</code>. <strong>Note</strong> that this can make the final recipe size
large. When <code>verbose = TRUE</code>, a message is written with the approximate
object size in memory but may be an underestimate since it does not take
environments into account.</p></dd>


<dt id="arg-log-changes">log_changes<a class="anchor" aria-label="anchor" href="#arg-log-changes"></a></dt>
<dd><p>A logical for printing a summary for each step regarding
which (if any) columns were added or removed during training.</p></dd>


<dt id="arg-strings-as-factors">strings_as_factors<a class="anchor" aria-label="anchor" href="#arg-strings-as-factors"></a></dt>
<dd><p>A logical: should character columns that have role
<code>"predictor"</code> or <code>"outcome"</code> be converted to factors? This affects the
preprocessed training set (when <code>retain = TRUE</code>) as well as the results of
<code><a href="bake.html">bake()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A recipe whose step objects have been updated with the required quantities
(e.g. parameter estimates, model objects, etc). Also, the <code>term_info</code> object
is likely to be modified as the operations are executed.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Given a data set, this function estimates the required quantities and
statistics needed by any operations. <code>prep()</code> returns an updated recipe with
the estimates. If you are using a recipe as a preprocessor for modeling, we
<strong>highly recommend</strong> that you use a <code>workflow()</code> instead of manually
estimating a recipe (see the example in <code><a href="recipe.html">recipe()</a></code>).</p>
<p>Note that missing data is handled in the steps; there is no global <code>na.rm</code>
option at the recipe level or in <code>prep()</code>.</p>
<p>Also, if a recipe has been trained using <code>prep()</code> and then steps are added,
<code>prep()</code> will only update the new operations. If <code>fresh = TRUE</code>, all of the
operations will be (re)estimated.</p>
<p>As the steps are executed, the <code>training</code> set is updated. For example, if the
first step is to center the data and the second is to scale the data, the
step for scaling is given the centered data.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="recipe.html">recipe()</a></code> and <code><a href="bake.html">bake()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ames</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">ames</span>, Sale_Price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Sale_Price</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ames_rec</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recipe.html">recipe</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">Longitude</span> <span class="op">+</span> <span class="va">Latitude</span> <span class="op">+</span> <span class="va">Neighborhood</span> <span class="op">+</span> <span class="va">Year_Built</span> <span class="op">+</span> <span class="va">Central_Air</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">ames</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="step_other.html">step_other</a></span><span class="op">(</span><span class="va">Neighborhood</span>, threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="step_dummy.html">step_dummy</a></span><span class="op">(</span><span class="fu"><a href="has_role.html">all_nominal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="step_interact.html">step_interact</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Central_Air"</span><span class="op">)</span><span class="op">:</span><span class="va">Year_Built</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="step_ns.html">step_ns</a></span><span class="op">(</span><span class="va">Longitude</span>, <span class="va">Latitude</span>, deg_free <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">prep</span><span class="op">(</span><span class="va">ames_rec</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 1 step other [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 2 step dummy [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 3 step interact [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 4 step ns [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The retained training set is ~ 0.48 Mb  in memory.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Inputs </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of variables by role</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> outcome:   1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> predictor: 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Training information </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Training data contained 2930 data points and no incomplete rows.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Operations </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">Neighborhood</span> | <span style="font-style: italic;">Trained</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">Neighborhood</span> <span style="color: #0000BB;">Central_Air</span> | <span style="font-style: italic;">Trained</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Interactions with: <span style="color: #0000BB;">Central_Air_Y:Year_Built</span> | <span style="font-style: italic;">Trained</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Natural splines on: <span style="color: #0000BB;">Longitude</span> <span style="color: #0000BB;">Latitude</span> | <span style="font-style: italic;">Trained</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">prep</span><span class="op">(</span><span class="va">ames_rec</span>, log_changes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_other (other_JgwxH): same number of columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_dummy (dummy_Fe2kG): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  new (9): Neighborhood_College_Creek, Neighborhood_Old_Town, ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  removed (2): Neighborhood, Central_Air</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_interact (interact_LGGmr): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  new (1): Central_Air_Y_x_Year_Built</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_ns (ns_lWKqm): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  new (10): Longitude_ns_1, Longitude_ns_2, Longitude_ns_3, ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  removed (2): Longitude, Latitude</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Inputs </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of variables by role</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> outcome:   1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> predictor: 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Training information </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Training data contained 2930 data points and no incomplete rows.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Operations </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">Neighborhood</span> | <span style="font-style: italic;">Trained</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">Neighborhood</span> <span style="color: #0000BB;">Central_Air</span> | <span style="font-style: italic;">Trained</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Interactions with: <span style="color: #0000BB;">Central_Air_Y:Year_Built</span> | <span style="font-style: italic;">Trained</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Natural splines on: <span style="color: #0000BB;">Longitude</span> <span style="color: #0000BB;">Latitude</span> | <span style="font-style: italic;">Trained</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, Emil Hvitfeldt, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

