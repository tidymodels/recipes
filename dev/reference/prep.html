<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate a preprocessing recipe — prep • recipes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet"><!--optional theme--><link href="../tidymodels.css" rel="stylesheet"><meta property="og:title" content="Estimate a preprocessing recipe — prep"><meta property="og:description" content="For a recipe with at least one preprocessing operation, estimate the required
parameters from a training set that can be later applied to other data
sets."><meta property="og:image" content="https://recipes.tidymodels.org/logo.png"><meta name="twitter:card" content="summary"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">recipes</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://tidymodels.org" class="external-link">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.17.9001</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/Simple_Example.html">Simple Example</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Selecting_Variables.html">Selecting Variables</a>
    </li>
    <li>
      <a href="https://www.tidymodels.org/learn/develop/recipes/" class="external-link">Custom Steps</a>
    </li>
    <li>
      <a href="../articles/Ordering.html">The Order of Steps</a>
    </li>
    <li>
      <a href="../articles/Dummies.html">Dummy Variables and Interactions</a>
    </li>
    <li>
      <a href="../articles/Roles.html">Column Roles</a>
    </li>
    <li>
      <a href="../articles/Skipping.html">On Skipping Steps</a>
    </li>
    <li>
      <a href="https://www.tidymodels.org/learn/models/sub-sampling/" class="external-link">Subsampling for Class Imbalances</a>
    </li>
    <li>
      <a href="https://www.tidymodels.org/learn/models/pls/" class="external-link">Multivariate Analysis using Partial Least Squares</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/recipes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate a preprocessing recipe</h1>
    <small class="dont-index">Source: <a href="https://github.com/tidymodels/recipes/blob/HEAD/R/recipe.R" class="external-link"><code>R/recipe.R</code></a></small>
    <div class="hidden name"><code>prep.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For a recipe with at least one preprocessing operation, estimate the required
parameters from a training set that can be later applied to other data
sets.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">prep</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for recipe</span>
<span class="fu">prep</span><span class="op">(</span>
  <span class="va">x</span>,
  training <span class="op">=</span> <span class="cn">NULL</span>,
  fresh <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  retain <span class="op">=</span> <span class="cn">TRUE</span>,
  log_changes <span class="op">=</span> <span class="cn">FALSE</span>,
  strings_as_factors <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>an object</p></dd>
<dt>...</dt>
<dd><p>further arguments passed to or from other methods (not currently
used).</p></dd>
<dt>training</dt>
<dd><p>A data frame or tibble that will be used to estimate
parameters for preprocessing.</p></dd>
<dt>fresh</dt>
<dd><p>A logical indicating whether already trained operation should be
re-trained. If <code>TRUE</code>, you should pass in a data set to the argument
<code>training</code>.</p></dd>
<dt>verbose</dt>
<dd><p>A logical that controls whether progress is reported as operations
are executed.</p></dd>
<dt>retain</dt>
<dd><p>A logical: should the <em>preprocessed</em> training set be saved
into the <code>template</code> slot of the recipe after training? This is a good
idea if you want to add more steps later but want to avoid re-training
the existing steps. Also, it is advisable to use <code>retain = TRUE</code>
if any steps use the option <code>skip = FALSE</code>. <strong>Note</strong> that this can make
the final recipe size large. When <code>verbose = TRUE</code>, a message is written
with the approximate object size in memory but may be an underestimate
since it does not take environments into account.</p></dd>
<dt>log_changes</dt>
<dd><p>A logical for printing a summary for each step regarding
which (if any) columns were added or removed during training.</p></dd>
<dt>strings_as_factors</dt>
<dd><p>A logical: should character columns be converted to
factors? This affects the preprocessed training set (when
<code>retain = TRUE</code>) as well as the results of <code>bake.recipe</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A recipe whose step objects have been updated with the required
quantities (e.g. parameter estimates, model objects, etc). Also, the
<code>term_info</code> object is likely to be modified as the operations are
executed.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Given a data set, this function estimates the required quantities and
statistics needed by any operations. <code>prep()</code> returns an updated recipe
with the estimates. If you are using a recipe as a preprocessor for modeling,
we <strong>highly recommend</strong> that you use a <code>workflow()</code> instead of manually
estimating a recipe (see the example in <code><a href="recipe.html">recipe()</a></code>).</p>
<p>Note that missing data is handled in the steps; there is no global
<code>na.rm</code> option at the recipe level or in <code>prep()</code>.</p>
<p>Also, if a recipe has been trained using <code>prep()</code> and then steps
are added, <code>prep()</code> will only update the new operations. If
<code>fresh = TRUE</code>, all of the operations will be (re)estimated.</p>
<p>As the steps are executed, the <code>training</code> set is updated. For example,
if the first step is to center the data and the second is to scale the
data, the step for scaling is given the centered data.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ames</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">ames</span>, Sale_Price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Sale_Price</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ames_rec</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="recipe.html">recipe</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">Longitude</span> <span class="op">+</span> <span class="va">Latitude</span> <span class="op">+</span> <span class="va">Neighborhood</span> <span class="op">+</span> <span class="va">Year_Built</span> <span class="op">+</span> <span class="va">Central_Air</span>,</span>
<span class="r-in">    data <span class="op">=</span> <span class="va">ames</span></span>
<span class="r-in">  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="step_other.html">step_other</a></span><span class="op">(</span><span class="va">Neighborhood</span>, threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="step_dummy.html">step_dummy</a></span><span class="op">(</span><span class="fu"><a href="has_role.html">all_nominal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="step_interact.html">step_interact</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Central_Air"</span><span class="op">)</span><span class="op">:</span><span class="va">Year_Built</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="step_ns.html">step_ns</a></span><span class="op">(</span><span class="va">Longitude</span>, <span class="va">Latitude</span>, deg_free <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">prep</span><span class="op">(</span><span class="va">ames_rec</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 1 step other [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 2 step dummy [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 3 step interact [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oper 4 step ns [training] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The retained training set is ~ 0.49 Mb  in memory.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recipe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inputs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       role #variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    outcome          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  predictor          5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Training data contained 2930 data points and no missing data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Operations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Collapsing factor levels for Neighborhood [trained]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy variables from Neighborhood, Central_Air [trained]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interactions with Central_Air_Y:Year_Built [trained]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Natural splines on Longitude, Latitude [trained]</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">prep</span><span class="op">(</span><span class="va">ames_rec</span>, log_changes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_other (other_XcaFj): same number of columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_dummy (dummy_p61GT): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  new (9): Neighborhood_College_Creek, Neighborhood_Old_Town, ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  removed (2): Neighborhood, Central_Air</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_interact (interact_z3KUD): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  new (1): Central_Air_Y_x_Year_Built</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step_ns (ns_SfTQ6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  new (10): Longitude_ns_1, Longitude_ns_2, Longitude_ns_3, ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  removed (2): Longitude, Latitude</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recipe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inputs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       role #variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    outcome          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  predictor          5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Training data contained 2930 data points and no missing data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Operations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Collapsing factor levels for Neighborhood [trained]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy variables from Neighborhood, Central_Air [trained]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interactions with Central_Air_Y:Year_Built [trained]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Natural splines on Longitude, Latitude [trained]</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="tidyverse">
  <p>recipes is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer></div>

  


  

  </body></html>

