<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a Recipe for Preprocessing Data — recipe • recipes</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href="../tidymodels.css" rel="stylesheet">




<meta property="og:title" content="Create a Recipe for Preprocessing Data — recipe" />
<meta property="og:description" content="A recipe is a description of what steps should be applied to a data set in
order to get it ready for data analysis." />
<meta property="og:image" content="https://recipes.tidymodels.org/logo.png" />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">recipes</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://tidymodels.org">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.15.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/Simple_Example.html">Simple Example</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Selecting_Variables.html">Selecting Variables</a>
    </li>
    <li>
      <a href="../articles/Custom_Steps.html">Custom Steps</a>
    </li>
    <li>
      <a href="../articles/Ordering.html">The Order of Steps</a>
    </li>
    <li>
      <a href="../articles/Dummies.html">Dummy Variables and Interactions</a>
    </li>
    <li>
      <a href="../articles/Roles.html">Column Roles</a>
    </li>
    <li>
      <a href="../articles/Skipping.html">On Skipping Steps</a>
    </li>
    <li>
      <a href="../articles/articles/Subsampling.html">Subsampling for Class Imbalances</a>
    </li>
    <li>
      <a href="../articles/articles/Multivariate_PLS.html">Multivariate Analysis using Partial Least Squares</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/recipes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a Recipe for Preprocessing Data</h1>
    <small class="dont-index">Source: <a href='https://github.com/tidymodels/recipes/blob/master/R/recipe.R'><code>R/recipe.R</code></a></small>
    <div class="hidden name"><code>recipe.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A recipe is a description of what steps should be applied to a data set in
order to get it ready for data analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>recipe</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>recipe</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>recipe</span><span class='op'>(</span><span class='va'>x</span>, formula <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span>, vars <span class='op'>=</span> <span class='cn'>NULL</span>, roles <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='co'># S3 method for formula</span>
<span class='fu'>recipe</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for matrix</span>
<span class='fu'>recipe</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x, data</th>
      <td><p>A data frame or tibble of the <em>template</em> data set
(see below).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to or from other methods (not currently
used).</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>A model formula. No in-line functions should be used here
(e.g. <code><a href='https://rdrr.io/r/base/Log.html'>log(x)</a></code>, <code>x:y</code>, etc.) and minus signs are not allowed. These types of
transformations should be enacted using <code>step</code> functions in this package.
Dots are allowed as are simple multivariate outcome terms (i.e. no need for
<code>cbind</code>; see Examples). A model formula may not be the best choice for
high-dimensional data with many columns, because of problems with memory.</p></td>
    </tr>
    <tr>
      <th>vars</th>
      <td><p>A character string of column names corresponding to variables
that will be used in any context (see below)</p></td>
    </tr>
    <tr>
      <th>roles</th>
      <td><p>A character string (the same length of <code>vars</code>) that
describes a single role that the variable will take. This value could be
anything but common roles are <code>"outcome"</code>, <code>"predictor"</code>,
<code>"case_weight"</code>, or <code>"ID"</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>recipe</code> with sub-objects:</p>
<dt>var_info</dt><dd><p>A tibble containing information about the original data
set columns</p></dd>
<dt>term_info</dt><dd><p>A tibble that contains the current set of terms in the
data set. This initially defaults to the same data contained in
<code>var_info</code>.</p></dd>
<dt>steps</dt><dd><p>A list of <code>step</code>  or <code>check</code> objects that define the sequence of
preprocessing operations that will be applied to data. The default value is
<code>NULL</code></p></dd>
<dt>template</dt><dd><p>A tibble of the data. This is initialized to be the same
as the data given in the <code>data</code> argument but can be different after
the recipe is trained.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Recipes are alternative methods for creating design matrices and
for preprocessing data.</p>
<p>Variables in recipes can have any type of <em>role</em> in subsequent analyses
such as: outcome, predictor, case weights, stratification variables, etc.</p>
<p><code>recipe</code> objects can be created in several ways. If the analysis only
contains outcomes and predictors, the simplest way to create one is to use
a simple formula (e.g. <code>y ~ x1 + x2</code>) that does not contain inline
functions such as <code><a href='https://rdrr.io/r/base/Log.html'>log(x3)</a></code>. An example is given below.</p>
<p>Alternatively, a <code>recipe</code> object can be created by first specifying
which variables in a data set should be used and then sequentially
defining their roles (see the last example). This alternative is an
excellent choice when the number of variables is very high, as the
formula method is memory-inefficient with many variables.</p>
<p>There are two different types of operations that can be
sequentially added to a recipe. <strong>Steps</strong>  can include common
operations like logging a variable, creating dummy variables or
interactions and so on. More computationally complex actions
such as dimension reduction or imputation can also be specified.
<strong>Checks</strong> are operations that conduct specific tests of the
data. When the test is satisfied, the data are returned without
issue or modification. Otherwise, any error is thrown.</p>
<p>Once a recipe has been defined, the <code><a href='prep.html'>prep()</a></code> function can be
used to estimate quantities required for the operations using a
data set (a.k.a. the training data). <code><a href='prep.html'>prep()</a></code> returns another
recipe.</p>
<p>To apply the recipe to a data set, the <code><a href='bake.html'>bake()</a></code> function is
used in the same manner as <code>predict</code> would be for models. This
applies the steps to any data set.</p>
<p>Note that the data passed to <code>recipe</code> need not be the complete data
that will be used to train the steps (by <code><a href='prep.html'>prep()</a></code>). The recipe
only needs to know the names and types of data that will be used. For
large data sets, <code>head</code> could be used to pass the recipe a smaller
data set to save time and memory.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Max Kuhn</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>###############################################</span>
<span class='co'># simple example:</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://modeldata.tidymodels.org'>modeldata</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>biomass</span><span class='op'>)</span>

<span class='co'># split data</span>
<span class='va'>biomass_tr</span> <span class='op'>&lt;-</span> <span class='va'>biomass</span><span class='op'>[</span><span class='va'>biomass</span><span class='op'>$</span><span class='va'>dataset</span> <span class='op'>==</span> <span class='st'>"Training"</span>,<span class='op'>]</span>
<span class='va'>biomass_te</span> <span class='op'>&lt;-</span> <span class='va'>biomass</span><span class='op'>[</span><span class='va'>biomass</span><span class='op'>$</span><span class='va'>dataset</span> <span class='op'>==</span> <span class='st'>"Testing"</span>,<span class='op'>]</span>

<span class='co'># When only predictors and outcomes, a simplified formula can be used.</span>
<span class='va'>rec</span> <span class='op'>&lt;-</span> <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>HHV</span> <span class='op'>~</span> <span class='va'>carbon</span> <span class='op'>+</span> <span class='va'>hydrogen</span> <span class='op'>+</span> <span class='va'>oxygen</span> <span class='op'>+</span> <span class='va'>nitrogen</span> <span class='op'>+</span> <span class='va'>sulfur</span>,
              data <span class='op'>=</span> <span class='va'>biomass_tr</span><span class='op'>)</span>

<span class='co'># Now add preprocessing steps to the recipe.</span>

<span class='va'>sp_signed</span> <span class='op'>&lt;-</span> <span class='va'>rec</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='step_normalize.html'>step_normalize</a></span><span class='op'>(</span><span class='fu'><a href='has_role.html'>all_predictors</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='step_spatialsign.html'>step_spatialsign</a></span><span class='op'>(</span><span class='fu'><a href='has_role.html'>all_predictors</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sp_signed</span>
</div><div class='output co'>#&gt; Data Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;       role #variables
#&gt;    outcome          1
#&gt;  predictor          5
#&gt; 
#&gt; Operations:
#&gt; 
#&gt; Centering and scaling for all_predictors()
#&gt; Spatial sign on  all_predictors()</div><div class='input'>
<span class='co'># now estimate required parameters</span>
<span class='va'>sp_signed_trained</span> <span class='op'>&lt;-</span> <span class='fu'><a href='prep.html'>prep</a></span><span class='op'>(</span><span class='va'>sp_signed</span>, training <span class='op'>=</span> <span class='va'>biomass_tr</span><span class='op'>)</span>
<span class='va'>sp_signed_trained</span>
</div><div class='output co'>#&gt; Data Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;       role #variables
#&gt;    outcome          1
#&gt;  predictor          5
#&gt; 
#&gt; Training data contained 456 data points and no missing data.
#&gt; 
#&gt; Operations:
#&gt; 
#&gt; Centering and scaling for carbon, hydrogen, oxygen, nitrogen, sulfur [trained]
#&gt; Spatial sign on  carbon, hydrogen, oxygen, nitrogen, sulfur [trained]</div><div class='input'>
<span class='co'># apply the preprocessing to a data set</span>
<span class='va'>test_set_values</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bake.html'>bake</a></span><span class='op'>(</span><span class='va'>sp_signed_trained</span>, new_data <span class='op'>=</span> <span class='va'>biomass_te</span><span class='op'>)</span>

<span class='co'># or use pipes for the entire workflow:</span>
<span class='va'>rec</span> <span class='op'>&lt;-</span> <span class='va'>biomass_tr</span> <span class='op'>%&gt;%</span>
  <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>HHV</span> <span class='op'>~</span> <span class='va'>carbon</span> <span class='op'>+</span> <span class='va'>hydrogen</span> <span class='op'>+</span> <span class='va'>oxygen</span> <span class='op'>+</span> <span class='va'>nitrogen</span> <span class='op'>+</span> <span class='va'>sulfur</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='step_normalize.html'>step_normalize</a></span><span class='op'>(</span><span class='fu'><a href='has_role.html'>all_predictors</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='step_spatialsign.html'>step_spatialsign</a></span><span class='op'>(</span><span class='fu'><a href='has_role.html'>all_predictors</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>###############################################</span>
<span class='co'># multivariate example</span>

<span class='co'># no need for `cbind(carbon, hydrogen)` for left-hand side</span>
<span class='va'>multi_y</span> <span class='op'>&lt;-</span> <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>carbon</span> <span class='op'>+</span> <span class='va'>hydrogen</span> <span class='op'>~</span> <span class='va'>oxygen</span> <span class='op'>+</span> <span class='va'>nitrogen</span> <span class='op'>+</span> <span class='va'>sulfur</span>,
                  data <span class='op'>=</span> <span class='va'>biomass_tr</span><span class='op'>)</span>
<span class='va'>multi_y</span> <span class='op'>&lt;-</span> <span class='va'>multi_y</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='step_center.html'>step_center</a></span><span class='op'>(</span><span class='fu'><a href='has_role.html'>all_outcomes</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='step_scale.html'>step_scale</a></span><span class='op'>(</span><span class='fu'><a href='has_role.html'>all_predictors</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>multi_y_trained</span> <span class='op'>&lt;-</span> <span class='fu'><a href='prep.html'>prep</a></span><span class='op'>(</span><span class='va'>multi_y</span>, training <span class='op'>=</span> <span class='va'>biomass_tr</span><span class='op'>)</span>

<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bake.html'>bake</a></span><span class='op'>(</span><span class='va'>multi_y_trained</span>, <span class='va'>biomass_te</span><span class='op'>)</span>

<span class='co'>###############################################</span>
<span class='co'># example with manually updating different roles</span>

<span class='co'># best choice for high-dimensional data:</span>

<span class='va'>rec</span> <span class='op'>&lt;-</span> <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>biomass_tr</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='roles.html'>update_role</a></span><span class='op'>(</span><span class='va'>carbon</span>, <span class='va'>hydrogen</span>, <span class='va'>oxygen</span>, <span class='va'>nitrogen</span>, <span class='va'>sulfur</span>,
           new_role <span class='op'>=</span> <span class='st'>"predictor"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='roles.html'>update_role</a></span><span class='op'>(</span><span class='va'>HHV</span>, new_role <span class='op'>=</span> <span class='st'>"outcome"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='roles.html'>update_role</a></span><span class='op'>(</span><span class='va'>sample</span>, new_role <span class='op'>=</span> <span class='st'>"id variable"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='roles.html'>update_role</a></span><span class='op'>(</span><span class='va'>dataset</span>, new_role <span class='op'>=</span> <span class='st'>"splitting indicator"</span><span class='op'>)</span>
<span class='va'>rec</span>
</div><div class='output co'>#&gt; Data Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;                 role #variables
#&gt;          id variable          1
#&gt;              outcome          1
#&gt;            predictor          5
#&gt;  splitting indicator          1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="tidyverse">
  <p>recipes is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn, <a href='http://hadley.nz'>Hadley Wickham</a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


