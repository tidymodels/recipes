<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Recipes • recipes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<meta property="og:title" content="Basic Recipes">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">recipes</a>
        <div class="info">
          <span class="partof">part of <a href="https://github.com/tidymodels">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.7.9001</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/Simple_Example.html">Simple Example</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Selecting_Variables.html">Selecting Variables</a>
    </li>
    <li>
      <a href="../articles/Custom_Steps.html">Custom Steps</a>
    </li>
    <li>
      <a href="../articles/Ordering.html">The Order of Steps</a>
    </li>
    <li>
      <a href="../articles/Dummies.html">Dummy Variables and Interactions</a>
    </li>
    <li>
      <a href="../articles/Roles.html">Column Roles</a>
    </li>
    <li>
      <a href="../articles/Skipping.html">On Skipping Steps</a>
    </li>
    <li>
      <a href="../articles/articles/Subsampling.html">Subsampling for Class Imbalances</a>
    </li>
    <li>
      <a href="../articles/articles/Multivariate_PLS.html">Multivariate Analysis using Partial Least Squares</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/recipes">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Basic Recipes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/recipes/blob/master/vignettes/Simple_Example.Rmd"><code>vignettes/Simple_Example.Rmd</code></a></small>
      <div class="hidden name"><code>Simple_Example.Rmd</code></div>

    </div>

    
    
<p>This document demonstrates some basic uses of recipes. First, some definitions are required:</p>
<ul>
<li>
<strong>variables</strong> are the original (raw) data columns in a data frame or tibble. For example, in a traditional formula <code>Y ~ A + B + A:B</code>, the variables are <code>A</code>, <code>B</code>, and <code>Y</code>.</li>
<li>
<strong>roles</strong> define how variables will be used in the model. Examples are: <code>predictor</code> (independent variables), <code>response</code>, and <code>case weight</code>. This is meant to be open-ended and extensible.</li>
<li>
<strong>terms</strong> are columns in a design matrix such as <code>A</code>, <code>B</code>, and <code>A:B</code>. These can be other derived entities that are grouped, such as a set of principal components or a set of columns, that define a basis function for a variable. These are synonymous with features in machine learning. Variables that have <code>predictor</code> roles would automatically be main effect terms.</li>
</ul>
<div id="an-example" class="section level2">
<h2 class="hasAnchor">
<a href="#an-example" class="anchor"></a>An Example</h2>
<p>The packages contains a data set used to predict whether a person will pay back a bank loan. It has 13 predictor columns and a factor variable <code>Status</code> (the outcome). We will first separate the data into a training and test set:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(recipes)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rsample)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"credit_data"</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">55</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">train_test_split &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/rsample/man/initial_split.html">initial_split</a></span>(credit_data)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">credit_train &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/rsample/man/initial_split.html">training</a></span>(train_test_split)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">credit_test &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/rsample/man/initial_split.html">testing</a></span>(train_test_split)</a></code></pre></div>
<p>Note that there are some missing values in these data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(credit_train, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(x)), <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt;    Status Seniority      Home      Time       Age   Marital   Records       Job </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;     1.000     1.000     0.999     1.000     1.000     1.000     1.000     1.000 </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;  Expenses    Income    Assets      Debt    Amount     Price </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;     1.000     0.919     0.988     0.996     1.000     1.000</span></a></code></pre></div>
<p>Rather than remove these, their values will be imputed.</p>
<p>The idea is that the preprocessing operations will all be created using the training set and then these steps will be applied to both the training and test set.</p>
</div>
<div id="an-initial-recipe" class="section level2">
<h2 class="hasAnchor">
<a href="#an-initial-recipe" class="anchor"></a>An Initial Recipe</h2>
<p>First, we will create a recipe object from the original data and then specify the processing steps.</p>
<p>Recipes can be created manually by sequentially adding roles to variables in a data set.</p>
<p>If the analysis only requires <strong>outcomes</strong> and <strong>predictors</strong>, the easiest way to create the initial recipe is to use the standard formula method:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">rec_obj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/recipe.html">recipe</a></span>(Status <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> credit_train)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">rec_obj</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; Data Recipe</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; Inputs:</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;       role #variables</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;    outcome          1</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;  predictor         13</span></a></code></pre></div>
<p>The data contained in the <code>data</code> argument need not be the training set; this data is only used to catalog the names of the variables and their types (e.g. numeric, etc.).</p>
<p>(Note that the formula method is used here to declare the variables, their roles and nothing else. If you use inline functions (e.g. <code>log</code>) it will complain. These types of operations can be added later.)</p>
</div>
<div id="preprocessing-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing-steps" class="anchor"></a>Preprocessing Steps</h2>
<p>From here, preprocessing steps for some step <em>X</em> can be added sequentially in one of two ways:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">rec_obj &lt;-<span class="st"> </span>step_{X}(rec_obj, arguments)    ## or</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">rec_obj &lt;-<span class="st"> </span>rec_obj <span class="op">%&gt;%</span><span class="st"> </span>step_{X}(arguments)</a></code></pre></div>
<p><code>step_dummy</code> and the other functions will always return updated recipes.</p>
<p>One other important facet of the code is the method for specifying which variables should be used in different steps. The manual page <code><a href="../reference/selections.html">?selections</a></code> has more details but <a href="https://cran.r-project.org/package=dplyr"><code>dplyr</code></a>-like selector functions can be used:</p>
<ul>
<li>use basic variable names (e.g. <code>x1, x2</code>),</li>
<li>
<a href="https://cran.r-project.org/package=dplyr"><code>dplyr</code></a> functions for selecting variables: <code>contains</code>, <code>ends_with</code>, <code>everything</code>, <code>matches</code>, <code>num_range</code>, and <code>starts_with</code>,</li>
<li>functions that subset on the role of the variables that have been specified so far: <code>all_outcomes</code>, <code>all_predictors</code>, <code>has_role</code>, or</li>
<li>similar functions for the type of data: <code>all_nominal</code>, <code>all_numeric</code>, and <code>has_type</code>.</li>
</ul>
<p>Note that the methods listed above are the only ones that can be used to select variables inside the steps. Also, minus signs can be used to deselect variables.</p>
<p>For our data, we can add an operation to impute the predictors. There are many ways to do this and <code>recipes</code> includes a few steps for this purpose:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"impute$"</span>, <span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="st">"package:recipes"</span>), <span class="dt">value =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt;  [1] "step_bagimpute"          "step_knnimpute"         </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;  [3] "step_lowerimpute"        "step_meanimpute"        </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;  [5] "step_medianimpute"       "step_modeimpute"        </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;  [7] "step_rollimpute"         "tunable.step_bagimpute" </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;  [9] "tunable.step_knnimpute"  "tunable.step_meanimpute"</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; [11] "tunable.step_rollimpute"</span></a></code></pre></div>
<p>Here, <em>K</em>-nearest neighbor imputation will be used. This works for both numeric and non-numeric predictors and defaults <em>K</em> to five To do this, it selects all predictors and then removes those that are numeric:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">imputed &lt;-<span class="st"> </span>rec_obj <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/step_knnimpute.html">step_knnimpute</a></span>(<span class="kw"><a href="../reference/has_role.html">all_predictors</a></span>()) </a>
<a class="sourceLine" id="cb6-3" data-line-number="3">imputed</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Data Recipe</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; Inputs:</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;       role #variables</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;    outcome          1</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;  predictor         13</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; Operations:</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; K-nearest neighbor imputation for all_predictors</span></a></code></pre></div>
<p>It is important to realize that the <em>specific</em> variables have not been declared yet (as shown when the recipe is printed above). In some preprocessing steps, variables will be added or removed from the current list of possible variables.</p>
<p>Since some predictors are categorical in nature (i.e. nominal), it would make sense to convert these factor predictors into numeric dummy variables (aka indicator variables) using <code>step_dummy</code>. To do this, the step selects all predictors then removes those that are numeric:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">ind_vars &lt;-<span class="st"> </span>imputed <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/step_dummy.html">step_dummy</a></span>(<span class="kw"><a href="../reference/has_role.html">all_predictors</a></span>(), <span class="op">-</span><span class="kw"><a href="../reference/has_role.html">all_numeric</a></span>()) </a>
<a class="sourceLine" id="cb7-3" data-line-number="3">ind_vars</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; Data Recipe</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; Inputs:</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;       role #variables</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;    outcome          1</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  predictor         13</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; Operations:</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; K-nearest neighbor imputation for all_predictors</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; Dummy variables from all_predictors, -, all_numeric()</span></a></code></pre></div>
<p>At this point in the recipe, all of the predictor should be encoded as numeric, we can further add more steps to center and scale them:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">standardized &lt;-<span class="st"> </span>ind_vars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/step_center.html">step_center</a></span>(<span class="kw"><a href="../reference/has_role.html">all_predictors</a></span>())  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/step_scale.html">step_scale</a></span>(<span class="kw"><a href="../reference/has_role.html">all_predictors</a></span>()) </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">standardized</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; Data Recipe</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; Inputs:</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;       role #variables</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;    outcome          1</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;  predictor         13</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; Operations:</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; K-nearest neighbor imputation for all_predictors</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; Dummy variables from all_predictors, -, all_numeric()</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; Centering for all_predictors</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; Scaling for all_predictors</span></a></code></pre></div>
<p>If these are the only preprocessing steps for the predictors, we can now estimate the means and standard deviations from the training set. The <code>prep</code> function is used with a recipe and a data set:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">trained_rec &lt;-<span class="st"> </span><span class="kw"><a href="../reference/prep.html">prep</a></span>(standardized, <span class="dt">training =</span> credit_train)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; Warning: Scaling `factor` should take either a value of 1 or 2</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">trained_rec</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; Data Recipe</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; Inputs:</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt;       role #variables</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;    outcome          1</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;  predictor         13</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; Training data contained 3341 data points and 303 incomplete rows. </span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; Operations:</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; K-nearest neighbor imputation for Home, Time, Age, Marital, Records, ... [trained]</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; Dummy variables from Home, Marital, Records, Job [trained]</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; Centering for Seniority, Time, Age, Expenses, Income, ... [trained]</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; Scaling for Seniority, Time, Age, Expenses, Income, ... [trained]</span></a></code></pre></div>
<p>Note that the real variables are listed (e.g. <code>Home</code> etc.) instead of the selectors (<code><a href="../reference/has_role.html">all_predictors()</a></code>).</p>
<p>Now that the statistics have been estimated, the preprocessing can be <em>applied</em> to the training and test set:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">train_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bake.html">bake</a></span>(trained_rec, <span class="dt">new_data =</span> credit_train)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">test_data  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bake.html">bake</a></span>(trained_rec, <span class="dt">new_data =</span> credit_test)</a></code></pre></div>
<p><code>bake</code> returns a tibble that, by default, includes all of the variables:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(test_data)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">test_data</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; # A tibble: 1,113 x 23</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;    Status Seniority   Time      Age Expenses   Income  Assets   Debt Amount</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;    &lt;fct&gt;      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt;  1 bad      0.257   -0.706  0.826      1.75   0.718   -0.199  -0.273  2.05 </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;  2 good     2.61     0.921  0.643      0.987 -0.221    0.386  -0.273  1.21 </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;  3 good     0.133   -2.33  -0.909     -1.05  -0.784   -0.449  -0.273 -1.76 </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;  4 good     0.00966  0.921 -0.635      0.987  0.705   -0.0316  1.86   0.995</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;  5 good     0.875   -1.52   1.37      -1.05   2.34     0.929  -0.273  0.995</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt;  6 good     3.10    -1.52   2.84       0.479  0.718   -0.0316  1.43  -0.912</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt;  7 good     2.24     0.921  1.28      -0.539  0.00436 -0.157  -0.273  0.677</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt;  8 bad     -0.979    0.108  0.00402   -1.05  -0.371   -0.265  -0.273  0.995</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt;  9 good     1.99     0.921  0.461      0.987 -0.0707  -0.115  -0.273 -0.276</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; 10 bad     -0.979    0.921 -0.453     -0.539 -0.00815  0.136   2.28   0.465</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; # … with 1,103 more rows, and 14 more variables: Price &lt;dbl&gt;, Home_other &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; #   Home_owner &lt;dbl&gt;, Home_parents &lt;dbl&gt;, Home_priv &lt;dbl&gt;, Home_rent &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt; #   Marital_married &lt;dbl&gt;, Marital_separated &lt;dbl&gt;, Marital_single &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt; #   Marital_widow &lt;dbl&gt;, Records_yes &lt;dbl&gt;, Job_freelance &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt; #   Job_others &lt;dbl&gt;, Job_partime &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(test_data, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(x)), <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">#&gt;            Status         Seniority              Time               Age </span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co">#&gt;                 1                 1                 1                 1 </span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="co">#&gt;          Expenses            Income            Assets              Debt </span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co">#&gt;                 1                 1                 1                 1 </span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co">#&gt;            Amount             Price        Home_other        Home_owner </span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="co">#&gt;                 1                 1                 1                 1 </span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="co">#&gt;      Home_parents         Home_priv         Home_rent   Marital_married </span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co">#&gt;                 1                 1                 1                 1 </span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="co">#&gt; Marital_separated    Marital_single     Marital_widow       Records_yes </span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="co">#&gt;                 1                 1                 1                 1 </span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="co">#&gt;     Job_freelance        Job_others       Job_partime </span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="co">#&gt;                 1                 1                 1</span></a></code></pre></div>
<p>Selectors can also be used. For example, if only the predictors are needed, you can use <code><a href="../reference/bake.html">bake(object, new_data, all_predictors())</a></code>.</p>
<p>There are a number of other steps included in the package:</p>
<pre><code>#&gt;  [1] "step_arrange"       "step_bagimpute"     "step_bin2factor"   
#&gt;  [4] "step_BoxCox"        "step_bs"            "step_center"       
#&gt;  [7] "step_classdist"     "step_corr"          "step_count"        
#&gt; [10] "step_date"          "step_depth"         "step_discretize"   
#&gt; [13] "step_downsample"    "step_dummy"         "step_factor2string"
#&gt; [16] "step_filter"        "step_geodist"       "step_holiday"      
#&gt; [19] "step_hyperbolic"    "step_ica"           "step_integer"      
#&gt; [22] "step_interact"      "step_intercept"     "step_inverse"      
#&gt; [25] "step_invlogit"      "step_isomap"        "step_knnimpute"    
#&gt; [28] "step_kpca"          "step_kpca_poly"     "step_kpca_rbf"     
#&gt; [31] "step_lag"           "step_lincomb"       "step_log"          
#&gt; [34] "step_logit"         "step_lowerimpute"   "step_meanimpute"   
#&gt; [37] "step_medianimpute"  "step_modeimpute"    "step_mutate"       
#&gt; [40] "step_mutate_at"     "step_naomit"        "step_nnmf"         
#&gt; [43] "step_normalize"     "step_novel"         "step_ns"           
#&gt; [46] "step_num2factor"    "step_nzv"           "step_ordinalscore" 
#&gt; [49] "step_other"         "step_pca"           "step_pls"          
#&gt; [52] "step_poly"          "step_profile"       "step_range"        
#&gt; [55] "step_ratio"         "step_regex"         "step_relu"         
#&gt; [58] "step_rename"        "step_rename_at"     "step_rm"           
#&gt; [61] "step_rollimpute"    "step_sample"        "step_scale"        
#&gt; [64] "step_shuffle"       "step_slice"         "step_spatialsign"  
#&gt; [67] "step_sqrt"          "step_string2factor" "step_unknown"      
#&gt; [70] "step_unorder"       "step_upsample"      "step_window"       
#&gt; [73] "step_YeoJohnson"    "step_zv"</code></pre>
</div>
<div id="checks" class="section level2">
<h2 class="hasAnchor">
<a href="#checks" class="anchor"></a>Checks</h2>
<p>Another type of operation that can be added to a recipes is a <em>check</em>. Checks conduct some sort of data validation and, if no issue is found, returns the data as-is; otherwise, an error is thrown.</p>
<p>For example, <code>check_missing</code> will fail if any of the variables selected for validation have missing values. This check is done when the recipe is prepared as well as when any data are baked. Checks are added in the same way as steps:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">trained_rec &lt;-<span class="st"> </span>trained_rec <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/check_missing.html">check_missing</a></span>(<span class="kw">contains</span>(<span class="st">"Marital"</span>))</a></code></pre></div>
<p>Currently, <code>recipes</code> includes:</p>
<pre><code>#&gt; [1] "check_class"      "check_cols"       "check_missing"    "check_name"      
#&gt; [5] "check_new_values" "check_range"      "check_type"</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#an-example">An Example</a></li>
      <li><a href="#an-initial-recipe">An Initial Recipe</a></li>
      <li><a href="#preprocessing-steps">Preprocessing Steps</a></li>
      <li><a href="#checks">Checks</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="tidyverse">
  <p>recipes is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn, <a href="http://hadley.nz">Hadley Wickham</a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
